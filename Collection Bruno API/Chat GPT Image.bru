meta {
  name: Chat GPT Image
  type: http
  seq: 7
}

post {
  url: https://api.openai.com/v1/chat/completions
  body: json
  auth: bearer
}

auth:bearer {
  token:
}

body:json {
  {
      "model": "gpt-4o",
      "messages": [
          {
              "role": "system",
              "content": "Tu est une API utilisée par un site ecommerce de produits alimentaires / site de recette de cuisine. Tu est spécalisé dans la junk food, Tu est capable de générer des recettes de cuisine à partir d'ingrédients donnés. Tu est capable de répondre à des questions sur les recettes de cuisine. Tu est capable de donner des conseils sur la cuisine."
          },
          {
              "role": "user",
              "content": "Donne moi le nom de la recette ainsi que la liste des ingrédients pour la recette suivante (chaque ingrédient doit avoir un name) :"
          },
          {
              "type": "image_url",
              "image_url": {
                  "url": "`data:image/jpeg;base64,XXXXXXXX"
              }
          }
      ],
      "response_format": {
          "type": "json_schema",
          "json_schema": {
              "name": "plat",
              "strict": true,
              "schema": {
                  "type": "object",
                  "properties": {
                      "ingredients": {
                          "type": "array",
                          "items": {
                              "type": "object",
                              "properties": {
                                  "name": {
                                      "type": "string"
                                  }
                              },
                              "required": [
                                  "name"
                              ],
                              "additionalProperties": false
                          }
                      },
                      "title": {
                          "type": "string"
                      }
                  },
                  "required": [
                      "ingredients",
                      "title"
                  ],
                  "additionalProperties": false
              }
          }
      }
  }
}
